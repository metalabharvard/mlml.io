{{ define "main" }}
  <section class="homepage-event grid-full grid h-event" vocab="https://schema.org/" typeof="Event">
    <header class="event-header grid-wide">
      {{ with .Params.Start_time }}<span class="event-timeago timeago" datetime="{{ dateFormat "2006-01-02 03:04:05 UTC" . }}"></span>{{ end }}
      <h1 class="event-name p-name" property="name">{{ .Params.Title }}</h1>
      {{ with .Params.Intro }}<span class="event-intro p-summary">{{ . | markdownify }}</span>{{ end }}
      {{ if .Params.Start_time }}
      <div class="timezone-tabs">
        <nav role="tablist" aria-label="Timezone selection">
          <button class="event-timezone btn-tab" role="tab" aria-controls="panel-boston" id="tab-boston" aria-selected="true" tabindex="0">{{ .Site.Params.timezoneBostonLabel }}</button>
          <button class="event-timezone btn-tab" role="tab" aria-controls="panel-berlin" id="tab-berlin" aria-selected="false" tabindex="-1">{{ .Site.Params.timezoneBerlinLabel }}</button>
        </nav>
        <div class="timezone-content">
          <time
            class="event-time"
            role="tabpanel"
            id="panel-boston"
            tabindex="0"
            aria-labelledby="tab-boston"
            property="startDate"
            content="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.New_York }}"
            datetime="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.New_York }}">
            {{- dateFormat "Monday, 2 January 3:04 pm" .Params.Start_time_locations.New_York }} {{ .Site.Params.timezoneBoston }}</time>
          <time
            class="event-time"
            role="tabpanel"
            id="panel-berlin"
            tabindex="-1"
            aria-labelledby="tab-berlin"
            hidden
            property="startDate"
            content="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.Berlin }}"
            datetime="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.Berlin }}">
            {{- dateFormat "Monday, 2 January 3:04 pm" .Params.Start_time_locations.Berlin }} {{ .Site.Params.timezoneBerlin }}</time>
        </div>
      </div>
      {{ end }}
    </header>
    <aside class="event-aside grid-narrow-right-aside">
      {{ partial "span-host.html" (dict "host" .Params.host "type" "event") }}
      <a href="{{ (printf `%s.ics` .Slug) | absURL }}">iCal</a>
    </aside>
    {{ with .Params.Link }}
    <a class="event-link u-url" href="{{ . }}" rel="noopener noreferrer external" target="_blank"><span>Visit event</span></a>
    {{ end }}
    {{ with .Content }}
    <div class="event-description grid-narrow-right e-content p-description">
      {{ . }}
    </div>
    {{ end }}
    {{ with .Params.Links }}
    <div class="event-links grid-narrow-right">
      <h2 class="related-links">{{ cond (eq (len .) 1) "Link" "Links" }}</h2>
      <ul>
      {{ range sort . "text" }}
        {{ partial "list-item.html" (dict "url" .url "text" .text "class" "link") }}
      {{ end }}
      </ul>
    </div>
    {{ end }}
    {{ partial "related-members.html" (dict "members" .Params.Members "term" "Involved") }}
    {{ partial "related-projects.html" (dict "projects" .Params.Projects "term" "Related") }}
    {{ $events := where (where (where .Site.RegularPages "Permalink" "ne" .Permalink) "Section" "events") "Params.topicids" "intersect" .Params.topicids }}
    {{ partial "related-events.html" (dict "events" $events "term" "Related") }}
  </section>
{{ end }}