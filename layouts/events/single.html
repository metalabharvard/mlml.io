{{ define "main" }}
  <section class="homepage-event grid-full grid h-event" vocab="https://schema.org/" typeof="Event">
    <header class="event-header grid-wide">
      {{ with .Params.Start_time }}<span class="event-timeago timeago" datetime="{{ dateFormat "2006-01-02 03:04:05 UTC" . }}"></span>{{ end }}
      <h1 class="event-name p-name" property="name">{{ .Params.Title }}</h1>
      {{ with .Params.Intro }}<span class="event-intro p-summary">{{ . | markdownify }}</span>{{ end }}
      {{ if .Params.Start_time }}
      <div class="timezone-tabs">
        <nav role="tablist" aria-label="Timezone selection">
          <button class="event-timezone btn-tab" role="tab" aria-controls="panel-boston" id="tab-boston" aria-selected="true" tabindex="0">{{ .Site.Params.Label.label_timezone_boston }}</button>
          <button class="event-timezone btn-tab" role="tab" aria-controls="panel-berlin" id="tab-berlin" aria-selected="false" tabindex="-1">{{ .Site.Params.Label.label_timezone_berlin }}</button>
        </nav>
        <div class="timezone-content">
          <time
            class="event-time"
            role="tabpanel"
            id="panel-boston"
            tabindex="0"
            aria-labelledby="tab-boston"
            property="startDate"
            content="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.New_York }}"
            datetime="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.New_York }}">
            {{- (dateFormat "Monday, 2 January 3:04&thinsp;pm" .Params.Start_time_locations.New_York) | safeHTML }} {{ .Site.Params.timezoneBoston }}</time>
          <time
            class="event-time"
            role="tabpanel"
            id="panel-berlin"
            tabindex="-1"
            aria-labelledby="tab-berlin"
            hidden
            property="startDate"
            content="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.Berlin }}"
            datetime="{{ dateFormat "2006-01-02T15:04:05-0700" .Params.Start_time_locations.Berlin }}">
            {{- (dateFormat "Monday, 2 January 3:04&thinsp;pm" .Params.Start_time_locations.Berlin) | safeHTML }} {{ .Site.Params.timezoneBerlin }}</time>
        </div>
      </div>
      {{ end }}
    </header>
    {{ $events := .Params.Events }}
    {{ $members := .Params.Members }}
    {{ $projects := .Params.Projects }}
    {{ $count := partial "columnCount.html" (dict "list" (slice $members $projects $events)) }}
    {{ if gt $count 0 }}
    <aside class="event-relations grid-wide grid grid-v-default half">
      {{ partial "related-members.html" (dict "members" $members "term" "Involved") }}
      {{ partial "related-projects.html" (dict "projects" $projects "term" "Related") }}
      {{ partial "related-events.html" (dict "events" $events "term" "Related") }}
    </aside>
    {{ end }}
    <aside class="event-aside grid-narrow-right-aside">
      {{ partial "span-host.html" (dict "host" .Params.host "type" "event") }}
      <a href="{{ (printf `%s.ics` .Slug) | absURL }}">iCal</a>
    </aside>
    {{ with .Params.Link }}
    <a class="event-link u-url" href="{{ . }}" rel="noopener noreferrer external" target="_blank"><span>Visit event</span></a>
    {{ end }}
    {{ with .Content }}
    <div class="event-description grid-narrow-right e-content p-description">
      {{ . }}
    </div>
    {{ end }}
    {{ with .Params.Links }}
    <div class="event-links grid-narrow-right">
      <h2 class="related-links">{{ cond (eq (len .) 1) "Link" "Links" }}</h2>
      <ul>
      {{ range sort . "label" }}
        {{ partial "list-item.html" (dict "url" .url "label" .label "class" "link") }}
      {{ end }}
      </ul>
    </div>
    {{ end }}
    <footer class="event-footer grid-narrow-right" role="contentinfo">
      <span>Page published on <time datetime="{{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" }}">{{ .PublishDate.Format "2 January 2006" }}</time>{{ if not (eq (.PublishDate.Format "2 January 2006") (.Lastmod.Format "2 January 2006"))}} and last edited on <time class="article-date" datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Lastmod.Format "2 January 2006" }}</time>{{ end }}.</span>
    </footer>
  </section>
{{ end }}